{
    "name": "Homematic Heizung",
    "settings": [
        {
            "type": "string",
            "id": "modalId",
            "default": "modal1",
            "description": "unique ID when using more than one of this widgets"
        },
        {
            "type": "checkbox",
            "id": "showtitle",
            "label": "Show Room title",
            "default": false
        },
        {
            "type": "string",
            "id": "title",
            "label": "Title"
        },
        {
            "type": "icon",
            "id": "backdrop",
            "label": "Icon"
        },
        {
            "type": "item",
            "id": "item",
            "label": "Room Item",
            "description": "Please select a Heater (like hm-rpc.1.000XXXXXXXXX)"
        }
    ],
    "author": "Robert Gröber",
    "description": "Homematic heater display and control",
    "template": "<style>\n  .homematic-wrapper {\n    cursor: pointer;\n  \tposition:relative;\n  \tz-index:99;\n  }\n  .heat-demand, \n\t.temperature {\n  \tdisplay:inline-block;\n  \tfont-size: 3vw;\n  }\n  .temperature .unit {\n  \tfont-size: 2vw;\n  }\n  .set-temperature {\n  \tfont-size: 1.4vw;\n    color: #0db9f0;\n  }\n\t.mode-selection, .boost-selection, .heater-mode {\n  \tfont-size: 1.4vw;\n  }\n  .low-batt .glyphicon {\n  \tcoor: red;\n  }\n  .mode-selection, .boost-selection {\n  \theight: 250px;\n  }\n</style>\n\n<div ng-init=\"config.id=config.item.replace('.','')\"/>\n\n<script type=\"text/ng-template\" id=\"modal-heater\">\n    <a class=\"btn btn-default close\" ng-click=\"$close()\">close</a>\n    <div class=\"container\">\n      \n      <!-- Chart \n      <div ng-init='data={\n                    \"name\": \"Temperature\",\n                    \"sizeX\": 12,\n                    \"sizeY\": 6,\n                    \"item\": \"sql.0\",\n                    \"type\": \"chart\",\n                    \"row\": 6,\n                    \"col\": 0,\n                    \"charttype\": \"interactive\",\n                    \"period\": \"D\",\n                    \"axis\": {\n                        \"y\": {\n                            \"includezero\": true\n                        }\n                    },\n                    \"series\": [\n                        {\n                            \"axis\": \"y\",\n                            \"display_line\": true,\n                            \"display_area\": true,\n                            \"item\": config.item + \".1.SET_POINT_TEMPERATURE\",\n                            \"name\": \"Temperature\",\n                            \"color\": \"#FF0000\"\n                        }\n                        \n                    ]\n                }'/>\n      \n      <widget-chart ng-model=\"data\" />\n      -->\n      \n      <!-- Set Point -->\n      <div class=\"col-sm-12\" ng-init=\"setpointmodel={ \n                    name: 'Setpoint', \n                    item: config.item + '.1.SET_POINT_TEMPERATURE', \n                    floor: 0, \n                    ceil: 30, \n                    step: 0.5,\n                    hidelabel: true,\n                    unit: '°C'\n                    }\">\n        <widget-slider ng-model=\"setpointmodel\"></widget-slider>\n      </div>\n      \n      <div class=\"heater-level\">\n        <span>Level: {{itemValue(config.item + '.1.LEVEL')}}</span>\n      </div>\n      \n      <!-- Mode -->\n      <div class=\"col-sm-6\">\n        <div class=\"box\">\n          <div class=\"box-content mode-selection\" ng-init=\"modemodel={\n                                                        name: 'Mode',\n                                                        item: config.item + '.1.SET_POINT_MODE',\n                                                        square: true,\n                                                        choices_columns: 2,\n                                                        choices_source: 'csv',\n                                                        no_highlight: true,\n                                                        hidestate: false,\n                                                        choices: '0=Auto,1=Manual'\n                                                        };\">\n            <widget-selection ng-model=\"modemodel\"></widget-selection>\n          </div>\n        </div>\n      </div>\n\n      <!-- Boost -->\n      <div class=\"col-sm-6\">\n        <div class=\"box\">\n          <div class=\"box-content boost-selection\" ng-init=\"boostmodel = {\n                                                         name: 'Boost',\n                                                         item: config.item + '.1.BOOST_TIME',\n                                                         square: true,\n                                                         choices_columns: 3,\n                                                         choices_source: 'csv',\n                                                         no_highlight: true,\n                                                         hidestate: false,\n                                                         choices: '0=Off,60=1 minute,300=5 minutes,3600=1 hour'\n                                                         };\">\n            <widget-selection ng-model=\"boostmodel\"></widget-selection>\n          </div>\n        </div>\n      </div>\n        \n    </div>\n</script>\n\n<widget-icon ng-if=\"config.backdrop\" iconset=\"config.backdrop_iconset\" icon=\"config.backdrop\"\n             backdrop=\"true\" center=\"true\"></widget-icon>\n\n<div class=\"homematic-wrapper\" ng-click=\"openModal('modal-heater', true, 'lg')\">\n  <div class=\"room-title\" ng-if=\"config.showtitle\">\n  \t<h2>{{config.title}}</h2> <span>{{config.name}}</span>\n  </div>\n\n  <!-- Heat Demand Icon -->\n  <div class=\"heat-demand\" ng-if=\"itemValue(config.item + '.1.LEVEL') > 0\">\n    <img width=\"16px\" height=\"16px\" ng-src=\"assets/icons/eclipse-smarthome-classic/fire.svg\" title=\"fire\" src=\"assets/icons/eclipse-smarthome-classic/fire.svg\" />\n  </div>\n  \n  <!-- Display Temperature -->\n  <div class=\"temperature\">{{'%.1f' | sprintf:itemValue(config.item + '.1.ACTUAL_TEMPERATURE')}}<span class=\"unit\">°C</span></div> \n  <div class=\"set-temperature\">{{'%.1f' | sprintf:itemValue(config.item + '.1.SET_POINT_TEMPERATURE')}}<span class=\"unit\">°C</span></div> \n\n  <!-- Display Mode -->\n  <div class=\"heater-mode\" ng-if=\"itemValue(config.item + '.1.SET_POINT_MODE') == 0\">\n  \t<span>Auto</span>\n  </div>\n  <div class=\"heater-mode\" ng-if=\"itemValue(config.item + '.1.SET_POINT_MODE') == 1\">\n  \t<span>Manual</span>\n  </div>\n  \n  <!-- Display Boost -->\n  <div class=\"low-batt\" ng-if=\"itemValue(config.item + '.0.LOW_BAT') == 'true'\">\n    <i class=\"glyphicon glyphicon-exclamation-sign\" ></i>\n    <span class=\"boost-remaining\">LOW BATTERY</span>\n  </div>\n  \n\t<!-- Display Boost -->\n  <div class=\"boost-remaining\" ng-if=\"itemValue(config.item + '.1.BOOST_MODE') == 'true'\">\n    <i class=\"glyphicon glyphicon-fire\" alt=\"boosting\"></i>\n    <span class=\"boost-remaining\">Boosting {{itemValue(config.item + '.1.BOOST_TIME')}} sec</span>\n  </div>\n\n</div>"
}
